---
export interface ProjectItem {
  name: string;
  description: string;
  link?: string;
  image?: string;
  skills?: string[];
}

interface Props {
  project: ProjectItem;
  index: number;
  accentColor: string;
}

const { project, index, accentColor } = Astro.props as Props;

const hasLink = !!project.link;
const hasImage = !!project.image;

const wrapperClasses =
  `block relative p-4 sm:p-6 md:p-8 bg-gray-50 rounded-xl sm:rounded-2xl border border-gray-200 transition-all duration-300 ${
    hasLink ? "hover:bg-white hover:shadow-xl hover:border-gray-300 hover:-translate-y-1" : ""
  }`;

const number = String(index + 1).padStart(2, "0");
---

<div class="group relative">
  {hasLink ? (
    <a
      href={project.link}
      target="_blank"
      rel="noopener noreferrer"
      class={wrapperClasses}
    >
      <div class={`grid grid-cols-1 ${hasImage ? "lg:grid-cols-12 gap-6" : ""}`}>
        {hasImage && (
          <div class="lg:col-span-5">
            <div class="relative overflow-hidden rounded-lg sm:rounded-xl border border-gray-200 bg-white">
              <div class="w-full h-48 sm:h-56 md:h-64">
                <img
                  src={project.image}
                  alt={project.name}
                  class="w-full h-full object-contain p-3"
                  loading="lazy"
                  decoding="async"
                />
              </div>
            </div>
          </div>
        )}

        <div class={`${hasImage ? "lg:col-span-7" : ""} space-y-4`}>
          <div class="flex items-start justify-between gap-4">
            <div>
              <span class="text-sm font-mono" style={`color:${accentColor}`}>
                {number}
              </span>
              <h3 class="text-xl sm:text-2xl font-bold text-gray-900 mt-1">
                {project.name}
              </h3>
            </div>

            <span
              class="inline-flex items-center justify-center
                     w-10 h-10 sm:w-11 sm:h-11 md:w-12 md:h-12
                     rounded-full bg-gray-900 text-white
                     transition-all duration-300 group-hover:bg-gray-700"
              aria-hidden="true"
            >
              <svg
                class="w-4 h-4 sm:w-[18px] sm:h-[18px] md:w-5 md:h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 17L17 7M17 7H7M17 7V17"
                />
              </svg>
            </span>
          </div>

          <p class={`text-base sm:text-lg text-gray-600 leading-relaxed ${hasLink ? "pr-2" : ""}`}>
            {project.description}
          </p>

          {project.skills?.length > 0 && (
            <div class="flex flex-wrap gap-1.5 sm:gap-2 pt-2">
              {project.skills.map((skill: string) => (
                <span
                  class={`px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-900 text-white rounded-md sm:rounded-lg text-xs sm:text-sm font-medium transition-all duration-300 ${
                    hasLink ? "group-hover:bg-gray-800" : ""
                  }`}
                >
                  {skill}
                </span>
              ))}
            </div>
          )}
        </div>
      </div>
    </a>
  ) : (
    <div class={wrapperClasses}>
      <div class={`grid grid-cols-1 ${hasImage ? "lg:grid-cols-12 gap-6" : ""}`}>
        {hasImage && (
          <div class="lg:col-span-5">
            <div class="relative overflow-hidden rounded-lg sm:rounded-xl border border-gray-200 bg-white">
              <div class="w-full h-48 sm:h-56 md:h-64">
                <img
                  src={project.image}
                  alt={project.name}
                  class="w-full h-full object-contain p-3"
                  loading="lazy"
                  decoding="async"
                />
              </div>
            </div>
          </div>
        )}

        <div class={`${hasImage ? "lg:col-span-7" : ""} space-y-4`}>
          <div>
            <span class="text-sm font-mono" style={`color:${accentColor}`}>
              {number}
            </span>
            <h3 class="text-xl sm:text-2xl font-bold text-gray-900 mt-1">
              {project.name}
            </h3>
          </div>

          <p class="text-base sm:text-lg text-gray-600 leading-relaxed">
            {project.description}
          </p>

          {project.skills?.length > 0 && (
            <div class="flex flex-wrap gap-1.5 sm:gap-2 pt-2">
              {project.skills.map((skill: string) => (
                <span class="px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-900 text-white rounded-md sm:rounded-lg text-xs sm:text-sm font-medium">
                  {skill}
                </span>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )}
</div>
